# Peptide Sequence Classification with LLM-CNN Pipeline

![Pipeline](workflow_final.png)

This repository contains the code and dataset used to classify peptide sequences using a multi-model pipeline that combines Large Language Models (LLMs) and Convolutional Neural Networks (CNNs). The pipeline also incorporates a Logistic Regression (LR) meta-classifier to produce final classification predictions.

## Overview

The pipeline consists of the following steps:

1. **Input Peptide Sequence**: The peptide sequence is passed through five pre-trained LLM-based models:

   - **BERT**
   - **BERT-BFD**
   - **T5**
   - **TF-BFD**
   - **XLNet**

2. **Embedding Generation**: The outputs from these models are processed to generate embeddings.

3. **CNN Processing**: The embeddings are then passed through Convolutional Neural Networks (CNNs) to produce probability scores.

4. **Meta-Classification**: These probability scores are passed to a Logistic Regression (LR) meta-classifier to make the final prediction.

## Repository Structure

The repository is organized as follows:

### Folders

- **Dataset/original_dataset**: Contains the dataset used for training and testing the models.
- **Dataset/Final Probability Dataset**: Contains the final dataset with probability scores generated by the pipeline.

### Notebooks

- **Code/LLM_CNN.ipynb**: This notebook contains the code for processing peptide sequences through the five LLM-based models, generating embeddings, and passing them through CNNs to compute the probability scores.
- **Code/Meta_classifier.ipynb**: This notebook contains the code for using the generated probability scores as input to a Logistic Regression (LR) meta-classifier to make the final predictions.

## How to Use

### Step 1: Clone the Repository

```bash
git clone https://github.com/SarfrazAhmad307/NLP701-Project.git
cd NLP701-PROJECT
```

### Step 2: Access Datasets

Navigate to the `Dataset/Original Dataset` directory to access datasets for Anti Viral, Neuro, and Bitter Peptides.

### Step 3: Run Code/LLM_CNN.ipynb

Navigate to the `Code/LLM_CNN.ipynb` jupyter notebook.
Open the notebook for your target peptide type.
Run the notebook to preprocess data, train, and generate probability scores file.
Run for each LLM_CNN pair for each peptide type.

### Step 4: Run Code/Meta_classifier.ipynb

Navigate to the `Code/Meta_classifier.ipynb` jupyter notebook.
Run the notebook to preprocess data, train, and evaluate the meta-classifier.

## Requirements

### Python Version

Python 3.8 or later

### Required Libraries

The following libraries are required to run the notebooks:

- `re`
- `string`
- `emoji`
- `pandas`
- `nltk`
- `stopwordsiso`
- `BeautifulSoup` (from `bs4`)
- `sklearn`
- `wordcloud`
- `matplotlib`
- `seaborn`
- `numpy`
- `transformers`
- `torch`
- `pickle`
- `tqdm`
- `warnings`
- `gc`
- `os`
- `requests`

### Install Dependencies

Install all required libraries using the following command:

```bash
pip install -r requirements.txt
```
